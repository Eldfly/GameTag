<!-- This page show all the threads in a topic -->
{% extends 'base.html' %}
{% load static %}
{% load humanize %}
{% load crispy_forms_tags %}
{% block content %}

  <form method="GET" class="mb-4" novalidate>
    {% csrf_token %}
    <button style="visibility: hidden;" type="submit" class="btn btn-gameTag">Search</button>
    {{searchThread.form|crispy}}
  </form>

  <ol class="breadcrumb my-4">
    <li class="breadcrumb-item"><a class='forum' href="{% url 'index' %}">Forums</a></li>
    <li class="breadcrumb-item"><a class='forum' href="{% url 'forum_topic' topic.forum.slug %}">{{ topic.forum.name }}</a></li>
    <li class="breadcrumb-item active">{{ topic.name }}</li>
  </ol>
{% if user.is_authenticated %}
  <div class="mb-4">
    <a href="{% url 'new_thread' topic.forum.slug topic.id %}" class="btn btn-gameTag">New thread</a>
  </div>
{% endif %}

{% if not threads %}
  <div class="mt-4">
  <i style="color:grey; font-size:2rem">This topic don't have any threads yet</i>
  </div>
{% else %}
  <table class="table">
   <thead class="thead-inverse">
     <tr>
       <th>Thread</th>
       <th>Starter</th>
       <th>Replies</th>
       <th>Views</th>
       <th>Last Update</th>
     </tr>
   </thead>
   <tbody>{{ thread_url }}
     {% for thread in threads %}
        {% url 'thread_posts' topic.forum.slug thread.slug as thread_url %}
       <tr>
         <td>
            <p class="mb-0">
              <a class="forum" href="{% url 'thread_posts' topic.forum.slug thread.topic.slug thread.id %}">{{ thread.name }}</a>
            </p>
            <small class="text-muted">
              Pages:
              {% for i in thread.get_page_range %}
                <a class="forum" href="{{ thread_url }}?page={{ i }}">{{ i }}</a>
              {% endfor %}
              {% if thread.has_many_pages %}
              ... <a class="forum" href="{{ thread_url }}?page={{ thread.get_page_count }}">Last Page</a>
              {% endif %}
            </small>
          </td>
         <td>{{ thread.creator.username }}</td>
         <td>{{thread.replies}}</td>
         <td>{{ thread.views }}</td>
         <td>{{ thread.last_activity|naturaltime }}</td>
       </tr>
     {% endfor %}
   </tbody>
 </table>
{% endif %}
 {% include 'includes/pagination.html' %}

{% endblock content %}
